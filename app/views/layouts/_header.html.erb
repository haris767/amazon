<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Amazon Navbar</title>
</head>
<body class="bg-white" data-controller='header'>
    <nav class="bg-gray-800 text-white p-2">
        <div class="container mx-auto flex items-center justify-between">
            <!-- Logo and Location -->
            <div class="flex items-center space-x-4">
                <%= link_to root_path do %>
                <span class="text-2xl font-bold text-yellow-500">amazon</span>
                <%end%>
               <button
  class="flex items-center gap-1"
  data-controller="delivery"
  data-delivery-target="deliveryButton"
  data-action="click->delivery#toggleDeliveryModal"
>
  <span class="flex items-center">
    <svg 
      xmlns="http://www.w3.org/2000/svg" 
      viewBox="0 0 24 24" 
      fill="currentColor" 
      width="12" 
      height="12">
      <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5S10.62 6.5 12 6.5s2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
    </svg>
    Deliver to &nbsp;<span class="delivery_location"><%= "Select a Country" %></span>
  </span>
</button>
            </div>

            <!-- Search Bar -->
            <div class="flex flex-grow mx-4">
                <select class="bg-gray-700 text-white p-2 rounded-l-md">
                    <option>All</option>
                </select>
                <input type="text" placeholder="Search Amazon" class="w-full p-2 text-black">
                <button class="bg-yellow-500 p-2 rounded-r-md">
                    üîç
                </button>
            </div>

            <!-- Right Side Links -->
            <div class="lg:relative lg:z-10 lg:ml-4 lg:flex lg:items-center">
                <%= link_to new_buy_product_path(
                product_id: params[:product_id], 
                quantity: params[:quantity], 
                style: params[:style], 
                size: params[:size], 
                shipping_cost: params[:shipping_cost], 
                total_price: params[:total_price]
                ) do %>
                 <button 
                 class="relative flex items-center space-x-1 px-4 py-2 bg-transparent text-white hover:bg-gray-800 rounded-lg">
                 <%# data-controller="cart" data-action="click->cart#toggleCartModal"> %>
        <!-- Cart Icon -->
        <svg xmlns="http://www.w3.org/2000/svg"
         width="28"
          height="28"
           viewBox="0 0 24 24" 
           fill="none" 
           stroke="white" 
           stroke-width="2"
            stroke-linecap="round" 
            stroke-linejoin="round">
            <path d="M6 6h15l-1.68 8.38a2 2 0 0 1-1.97 1.62H8.66a2 2 0 0 1-1.97-1.62L5 4H3"></path>
            <circle cx="9" cy="20" r="1"></circle>
            <circle cx="17" cy="20" r="1"></circle>
        </svg>

        <!-- Cart Count Badge -->
        
        <span class="absolute top-0 left-4 bg-orange-500 text-white text-xs font-bold px-1.5 py-0.5 rounded-full">
          <%=@quantity%>
        </span>
       
        <!-- Cart Text -->
        <span class="text-lg font-semibold">Cart</span>
    </button>
    <%end%>
                <!-- Profile dropdown -->
                <div class="relative ml-4 flex-shrink-0">
                    <div>
                        <button data-header-target="openUserMenu" 
                                type="button" 
                                class="relative flex items-center space-x-2 bg-transparent text-white focus:outline-none" 
                                id="user-menu-button" 
                                aria-expanded="false" 
                                aria-haspopup="true">
                                 <span class="text-xs"></span>
                                  <% if user_signed_in? && current_user.profile.picture.present? %>
                                <%= image_tag current_user.profile.picture, class:"h-8 w-8 rounded-full object-cover" %>
                                <% else %>
                                <img class="h-10 w-10 rounded-full" 
                                src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" 
                                alt="">
                                <% end %>
              
                                <span class="font-bold flex items-center">
                                Account & Lists
                                <svg class="w-4 h-4 ml-1" fill="white" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                </svg>
                            </span>
                           
                        </button>
                    </div>

                 <div data-header-target="dropdown"
     data-transition-enter="transition ease-out duration-100"
     data-transition-enter-start="transform opacity-0 scale-95"
     data-transition-enter-end="transform opacity-100 scale-100"
     data-transition-leave="transition ease-in duration-75"
     data-transition-leave-start="transform opacity-100 scale-100"
     data-transition-leave-end="transform opacity-0 scale-95"
     class="hidden absolute right-0 z-10 mt-2 w-80 origin-top-right bg-white shadow-lg rounded-md p-4 ring-1 ring-black ring-opacity-5 focus:outline-none" 
     role="menu" 
     aria-orientation="vertical" 
     aria-labelledby="user-menu-button" 
     tabindex="-1">
     
    <!-- Sign In Section -->
    <div class="text-center border-b pb-3">
        <% if user_signed_in? %>
          
            <%= button_to "Log out", destroy_user_session_path, method: :delete, class: "block w-full bg-yellow-500 text-black font-bold py-2 rounded-md", role: "menuitem", tabindex: "-1" %>
         <%#= link_to "Dashboard", purchases_path, class:"block px-4 py-2 text-sm text-gray-700", role:"menuitem", tabindex:"-1" %>
        <%= link_to "Dashboard", owner_purchases_path, class:"block px-4 py-2 text-sm text-gray-700", role:"menuitem", tabindex:"-1" %>
          <%= link_to "Account", edit_profile_path , class:"block px-4 py-2 text-sm text-gray-700", role:"menuitem", tabindex:"-1" %>
        <% else %>
            <%= link_to "Sign in", new_user_session_path, class: "block w-full bg-yellow-500 text-black font-bold py-2 rounded-md", role: "menuitem", tabindex: "-1" %>
            <p class="text-xs mt-1">New customer? <%= link_to "Start here.", new_user_registration_path, class: "text-blue-600" %></p>
        <% end %>
    </div>

    <!-- Account & Lists Section -->
    <div class="flex mt-3 text-sm">
        <!-- Your Lists -->
        <div class="w-1/2 border-r pr-3">
            <h3 class="font-bold mb-2">Your Lists</h3>
            <ul class="space-y-1">
                 <li><%= link_to "Orders", orders_path, class: "text-gray-700 hover:underline" %></li>
                 <li><%= link_to "Recent Order", order_path(id: 'most_recent'), class: "text-gray-700 hover:underline" %></li> <!-- Link to recent order -->
                <li><%= link_to "Create a List", "#", class: "text-gray-700 hover:underline" %></li>
                <li><%= link_to "Find a List or Registry", "#", class: "text-gray-700 hover:underline" %></li>
            </ul>

                </div>
            </div>
            
        </div>
         
   
    </nav>

    <!-- Sub Navbar -->
    <div class="bg-gray-700 text-white p-2">
        <div class="container mx-auto flex space-x-4 text-sm">
            <a href="#">All</a>
            <a href="#">Today's Deals</a>
            <a href="#">Customer Service</a>
            <a href="#">Registry</a>
            <a href="#">Gift Cards</a>
            <a href="#">Sell</a>
        </div>
    </div>
    <%#= render 'shared/modal', modalTriggerId: "cart", content: 'buy_product/cart_modal', content_params: {product: @product} %>
</body>
</html>
